<!-- <button (click)="printSlots ()">CLICK</button> -->
<svg:svg
  bgSvg
  xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="100%" height="100%"
  [attr.viewBox]="viewBox" preserveAspectratio="xMinYMin">
  <!-- <defs>
    <pattern id="mountain" height="100%" width="100%" patternContentUnits="objectBoundingBox">
      <image width="1" height="1" preserveAspectRatio="none" xlink:href="assets/barony/land-tiles/mountain.png"></image>
    </pattern>
    <pattern id="lake" height="100%" width="100%" patternContentUnits="objectBoundingBox">
      <image width="1" height="1" preserveAspectRatio="none" xlink:href="assets/barony/land-tiles/lake.png"></image>
    </pattern>
    <pattern id="plain" height="100%" width="100%" patternContentUnits="objectBoundingBox">
      <image width="1" height="1" preserveAspectRatio="none" xlink:href="assets/barony/land-tiles/plain.png"></image>
    </pattern>
    <pattern id="fields" height="100%" width="100%" patternContentUnits="objectBoundingBox">
      <image width="1" height="1" preserveAspectRatio="none" xlink:href="assets/barony/land-tiles/fields.png"></image>
    </pattern>
    <pattern id="forest" height="100%" width="100%" patternContentUnits="objectBoundingBox">
      <image width="1" height="1" preserveAspectRatio="none" xlink:href="assets/barony/land-tiles/forest.png"></image>
    </pattern>
  </defs> -->
  <svg:g
    #britMapMap
    [bgMapZoom]="{
      translateX: 0,
      translateY: 50,
      scale: 1
    }">
    <image [attr.width]="mapWidth" preserveAspectRatio="xMinYMin" xlink:href="assets/britannia/britannia-map.png"></image>
    <svg:g
      *ngFor="let areaNode of areaNodes; trackBy: areaTrackBy">
      <svg:path [attr.id]="'brit-area-' + areaNode.id" class="brit-area-path" [attr.d]="areaNode.path" (click)="onAreaClick (areaNode, $event)"></svg:path>
      
      <svg:circle *ngFor="let point of testGridPoints"
        [attr.cx]="point.x"
        [attr.cy]="point.y"
        [attr.r]="3"
        [attr.style]="'fill: ' + point.color"></svg:circle>
      
      <ng-container *ngIf="slotsReady">
        <ng-container *ngFor="let unitNode of areaNode.unitNodes; trackBy: unitTrackBy">
          <svg:g *ngLet="{
            x: unitNode | bgTransform:getUnitNodeX:areaNode,
            y: unitNode | bgTransform:getUnitNodeY:areaNode
          } as c">
            <svg:rect
              class="brit-unit-rect"
              [attr.x]="c.x"
              [attr.y]="c.y"
              width="30"
              height="30">
            </svg:rect>
            <svg:image
              [attr.x]="c.x"
              [attr.y]="c.y"
              width="30"
              [attr.xlink:href]="unitNode.imageSource"/>
          </svg:g>
        </ng-container>
      </ng-container>


      <!-- <svg:g
        *ngFor="let slot of (areaNode.id | bgTransform:getSlotByArea:slotsByArea); let i = index">
        <svg:rect
          (click)="onSlotRectClick (i, areaNode)"
          [attr.x]="slot.x - 15 - 3"
          [attr.y]="slot.y - 15 - 3"
          width="30" height="30" rx="5"
          style="fill: transparent; stroke: black; stroke-width: 3px;"></svg:rect>
          <svg:text
          [attr.x]="slot.x"
          [attr.y]="slot.y">
            {{i}}
          </svg:text> -->
        <!-- <svg:image
          [attr.x]="slot.x - 15"
          [attr.y]="slot.y - 15"
          width="30"
          xlink:href="assets/britannia/infantries/romans.png"/> -->
      <!-- </svg:g> -->

    </svg:g>
      <!-- baronyLandTile
      [type]="land.type"
      [coordinates]="land.coordinates"
      [pawns]="land.pawns"
      [active]="isValid ? isValid[land.id] : false"
      [disabled]="isValid ? !isValid[land.id] : false"
      (landTileClick)="onLandTileClick (land)"> -->
  </svg:g>
</svg:svg>
