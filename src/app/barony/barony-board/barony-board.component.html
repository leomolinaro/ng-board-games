<div class="b-board">
  <div class="b-board-map-layer">
    <barony-map
      [lands]="(lands$ | async)!"
      [validLands]="(validLands$ | async)!"
      (landTileClick)="onLandTileClick ($event)">
    </barony-map>
  </div>
  <div class="b-board-widgets-layer" *ngLet="currentPlayer$ | async as currentPlayer">
    <div
      [class]="'b-board-instructions-widget' + (currentPlayer ? (' is-' + currentPlayer.color) : '')">
      <div class="b-board-instructions">{{ message$ | async }}</div>
      <barony-knights-selector
        *ngIf="maxNumberOfKnights$ | async as maxNumberOfKnights"
        [(number)]="numberOfKnights"
        [max]="maxNumberOfKnights"
        min=1
        (confirm)="onKnightsConfirm ()">
      </barony-knights-selector>
    </div>
    <ng-container *ngLet="validActions$ | async as validActions">
      <ng-container *ngLet="canPass$ | async as canPass">
        <ng-container *ngLet="canCancel$ | async as canCancel">
          <barony-actions
            class="b-board-actions-widget"
            *ngIf="validActions || canPass || canCancel"
            [canPass]="canPass"
            [canCancel]="canCancel"
            [validActions]="validActions"
            (actionClick)="onActionClick ($event)"
            (passClick)="onPassClick ()"
            (cancelClick)="onCancelClick ()">
          </barony-actions>
        </ng-container>
      </ng-container>
    </ng-container>
    <!-- <div class="b-board-bottom-left" *ngLet="validResources$ | async as validResources">
      <div *ngFor="let otherPlayer of (otherPlayers$ | async); trackBy: playerTrackBy" class="b-board-player-widget">
        <barony-player-status
          (selectPlayer)="onPlayerSelect (otherPlayer)"
          [player]="otherPlayer"
          [validResources]="(validResources && validResources.player === otherPlayer.id) ? validResources.resources : null"
          (clickResource)="onPlayerResourceClick ($event, otherPlayer)">
        </barony-player-status>
      </div>
      <div class="b-board-player-widget" *ngIf="currentPlayer">
        <barony-player-status
          [player]="currentPlayer"
          [validBuildings]="validBuildings$ | async"
          [validResources]="(validResources && validResources.player === currentPlayer.id) ? validResources.resources : null"
          (clickPawn)="onPlayerBuildingClick ($event)"
          (clickResource)="onPlayerResourceClick ($event, currentPlayer)"
          currentPlayer>
        </barony-player-status>
      </div>
    </div> -->
  </div>
</div>