<div class="wotr-board">
  <wotr-map
    class="wotr-map"
    #wotrMap
    [regions]="regions ()"
    [validRegions]="validRegions"
    [nations]="nations ()"
    [companionById]="companionById ()"
    [minionById]="minionById ()"
    (regionClick)="onRegionClick ($event)">
  </wotr-map>
  <div class="wotr-toolbar">{{ message () }}  <button (click)="testClick.next ()">Test</button></div>
  <div class="wotr-fronts">
    <mat-tab-group>
      @for (front of fronts (); track front.id) {
        <mat-tab [label]="front.name + ' ' + (front.handCards | bgTransform:nChaCards) + ' / ' + (front.handCards | bgTransform:nStrCards)"
          [labelClass]="front.id" [bodyClass]="front.id">
          <wotr-front-area
            [front]="front"
            [nations]="front.id === 'free-peoples' ? freePeopleNations () : shadowNations ()"
            [companions]="front.id === 'free-peoples' ? companions () : undefined"
            [minions]="front.id === 'shadow' ? minions () : undefined"
            (cardClick)="onPreviewCardClick ($event, front)">
          </wotr-front-area>
        </mat-tab>
      }
      <mat-tab [label]="'Hunt (' + hunt ().nHuntDice + ' / ' + hunt ().nFreePeopleDice + ')'">
        <wotr-hunt-area
          [hunt]="hunt ()">
        </wotr-hunt-area>
      </mat-tab>
    </mat-tab-group>
  </div>
  <div class="wotr-action-dice-box">
    @for (front of fronts (); track front.id) {
      <div class="wotr-action-dice">
        @for (actionDie of front.actionDice; track actionDie) {
          <img [src]="actionDie | bgTransform:actionDieImage:front.id"/>
        }
        @for (actionToken of front.actionTokens; track actionToken) {
          <img [src]="actionToken | bgTransform:actionTokenImage:front.id"/>
        }
      </div>
    }
  </div>
  <div class="wotr-logs">
    <wotr-logs [logs]="logs ()"></wotr-logs>
  </div>
    <!-- [nationStates]="nationStates"
    [validUnits]="validUnits"
    [selectedUnits]="selectedUnits"
    (unitClick)="onUnitClick ($event)" -->
</div>
